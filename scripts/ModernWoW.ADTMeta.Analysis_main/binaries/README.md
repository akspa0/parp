<path>README.md</path>
<content># ADT Analysis Tools

This repository contains two tools for analyzing World of Warcraft ADT (Area Definition Table) files:

1.  **ADT Analyzer:** Analyzes ADT files for references and generates reports.
2.  **Unique ID Analyzer:** Analyzes unique IDs from ADT analysis results.

## 1. ADT Analyzer (`ModernWoWTools.ADTMeta.Analysis`)

### Overview

The ADT Analyzer is a command-line tool that parses and analyzes World of Warcraft ADT files. It extracts information about referenced assets (models, textures, etc.) and can validate these references against a provided listfile. The tool generates reports in either plain text or JSON format, and it supports logging to both the console and a file.

### Features

*   **ADT Parsing:** Extracts data from ADT files, including referenced models (M2), doodads (WMO), and textures (BLP).
*   **Reference Validation:** Checks extracted references against a provided listfile to identify missing or invalid entries.
*   **Report Generation:** Creates reports summarizing the analysis, including:
    *   Total number of ADT files processed.
    *   Number of valid and invalid references.
    *   List of missing files (if a listfile is provided).
    *   Optional JSON output for structured data.
*   **Recursive Search:** Optionally searches subdirectories for ADT files.
*   **Verbose Logging:** Provides detailed logging information for debugging and analysis.
*   **Configurable Output:** Allows specifying an output directory for reports.
*   **Error Handling:** Includes error handling and logging for robust operation.
*   **Uses System.CommandLine:** Leverages the `System.CommandLine` library for a user-friendly command-line interface.

### Installation and Usage

This tool is a .NET application. You'll need the .NET SDK installed to build and run it.

1.  **Clone the repository:**

    ```bash
    git clone [repository URL]
    ```
    (Replace `[repository URL]` with the actual URL of this repository.)

2.  **Navigate to the project directory:**

    ```bash
    cd ModernWoWTools.ADTMeta.Analysis
    ```

3.  **Build the project:**

    ```bash
    dotnet build
    ```

4.  **Run the tool:**

    ```bash
    dotnet run -- [options] --directory <directory>
    ```

    Or, after publishing:

    ```
    ./ModernWoWTools.ADTMeta.Analysis --directory <directory> [options]
    ```

**Options:**

*   `-d, --directory <directory>` (Required): The directory containing the ADT files to analyze.
*   `-l, --listfile <listfile>`: The path to the listfile for reference validation (optional).
*   `-o, --output <output>`: The directory to write reports to (optional). Defaults to the input directory or a subdirectory within it.
*   `-r, --recursive`: Whether to search subdirectories (default: false).
*   `-v, --verbose`: Whether to enable verbose logging (default: false).
*   `-j, --json`: Whether to generate JSON reports (default: false).  If enabled, output will be placed in a "json" subdirectory within the specified output directory (or the input directory if no output is specified).

**Example:**

To analyze all ADT files in the `D:\WoW\Extracted\maps` directory, validate references against `D:\listfile.txt`, generate JSON reports in `D:\ADTAnalysisReports`, and enable verbose logging:

```bash
dotnet run -- --directory "D:\WoW\Extracted\maps" --listfile "D:\listfile.txt" --output "D:\ADTAnalysisReports" --recursive --verbose --json
Notes
The tool creates a log file in a logs subdirectory within the output directory (or the input directory if no output directory is specified).
The JSON report, if enabled, will be written to a json subdirectory within the output directory.
2. Unique ID Analyzer (ModernWoWTools.ADTMeta.Analysis.UniqueIdAnalysis)
Overview
The Unique ID Analyzer is a command-line tool designed to process the output (specifically, the results.txt files) generated by the ADT Analyzer. It identifies clusters of unique IDs, analyzes gaps between IDs, and can perform advanced analysis to detect potential collisions and identify unique assets.

Features
Cluster Analysis: Groups unique IDs into clusters based on proximity, helping identify related assets.
Gap Analysis: Detects significant gaps between unique IDs within clusters, potentially indicating missing assets or data inconsistencies.
Configurable Thresholds: Allows customization of cluster and gap thresholds to fine-tune analysis.
Advanced Analysis (Optional): Performs in-depth analysis to identify:
Unique ID Collisions: Cases where the same ID is used for different assets.
Unique Assets: Assets that appear only once across all analyzed data.
Comprehensive Report (Optional): Generates a detailed report including all assets and non-clustered IDs.
Uses ADT Files from ADT Analyzer: Leverages the ADT file information gathered by the ADT Analyzer for advanced analysis.
Installation and Usage
This tool is also a .NET application and requires the .NET SDK.

Clone the repository: (Same as ADT Analyzer)

Navigate to the project directory:

cd ModernWoWTools.ADTMeta.Analysis.UniqueIdAnalysis
Build the project:

dotnet build
Run the tool:

dotnet run -- <results_directory> <output_directory> [cluster_threshold] [gap_threshold] [-noadvanced] [-nocomprehensive]
Or, after publishing:

./ModernWoWTools.ADTMeta.Analysis.UniqueIdAnalysis <results_directory> <output_directory> [cluster_threshold] [gap_threshold] [-noadvanced] [-nocomprehensive]
Arguments:

<results_directory> (Required): The directory containing the results.txt files generated by the ADT Analyzer.
<output_directory> (Required): The directory where the Unique ID Analyzer will write its reports.
[cluster_threshold] (Optional): The minimum number of IDs for a cluster (default: 10).
[gap_threshold] (Optional): The maximum gap between IDs in a cluster (default: 1000).
[-noadvanced] (Optional): Disables the advanced analysis (collision and unique asset detection).
[-nocomprehensive] (Optional): Disables generation of the comprehensive report.
Interactive Mode:

If you run the tool without providing the required arguments, it will prompt you for them interactively:

Enter results directory: [Enter path]
Enter output directory: [Enter path]
Enter cluster threshold (minimum IDs for a cluster, default 10): [Enter value or press Enter for default]
Enter gap threshold (maximum gap between IDs in a cluster, default 1000): [Enter value or press Enter for default]
Run advanced analysis for uniqueID collisions and unique assets? (Y/n): [Enter Y or n]
Generate comprehensive report with all assets and non-clustered IDs? (Y/n): [Enter Y or n]
Example:

To analyze the results in D:\ADTAnalysisReports, output to D:\UniqueIDAnalysis, use a cluster threshold of 5, a gap threshold of 500, enable advanced analysis, and generate a comprehensive report:

dotnet run -- "D:\ADTAnalysisReports" "D:\UniqueIDAnalysis" 5 500
Notes
The tool expects results.txt files in the specified results directory, as generated by the ADT Analyzer.
The advanced analysis relies on the ADT files processed by the ADT Analyzer. Ensure these files are accessible.
The comprehensive report can be quite large, especially for extensive datasets.